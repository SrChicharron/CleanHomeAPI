CREATE DATABASE CLEANHOME;
USE CLEANHOME;

CREATE TABLE USER(
    USERNAME VARCHAR(50) NOT NULL,
    EMAIL VARCHAR(50) NOT NULL,
    ENABLED BIT(1),
    PASSWORD VARCHAR(255) NOT NULL,
    PRIMARY KEY (USERNAME)
);

CREATE TABLE ROL(
    ID INT NOT NULL AUTO_INCREMENT,
    AUTHORITY VARCHAR(50) NOT NULL,
    USERNAME VARCHAR(50) NOT NULL,
    INDEX USERNM (USERNAME),
        FOREIGN KEY (USERNAME)
            REFERENCES USER(USERNAME)
            ON DELETE CASCADE,
        PRIMARY KEY (ID)
);

CREATE TABLE CLIENTE(
    ID INT NOT NULL AUTO_INCREMENT,
    NAME VARCHAR(30) NOT NULL,
    LASTNAME VARCHAR(30) NOT NULL,
    CELLPHONE VARCHAR(10) NOT NULL,
    BIRTHDAY TIMESTAMP NOT NULL,
    USERNAME VARCHAR(50) NOT NULL,
    INDEX USERNM (USERNAME),
        FOREIGN KEY (USERNAME)
            REFERENCES USER(USERNAME)
            ON DELETE CASCADE,
        PRIMARY KEY (ID)
);

CREATE TABLE SERVICIO(
    ID INT NOT NULL AUTO_INCREMENT,
    NOMBRE VARCHAR(50) NOT NULL,
    DESCRIPCION VARCHAR(150) NOT NULL,
    PRIMARY KEY (ID)
);

CREATE TABLE PROPIEDAD(
    ID INT NOT NULL AUTO_INCREMENT,
    TITULO VARCHAR(35) NOT NULL,
    TIPO VARCHAR(35) NOT NULL,
    CALLE_AVENIDA VARCHAR(50) NOT NULL,
    NUMEXT INT NOT NULL,
    CP INT NOT NULL,
    IMAGEN LONGBLOB NOT NULL,
    PRIMARY KEY (ID)
);

--INSERT INTO PROPIEDAD(TITULO,TIPO,CALLE_AVENIDA,NUMEXT,CP,IMAGEN)
--VALUES("MI PROPIEDAD CHIDA","MANSION","CALLE UTEQ CUESTA",99,76122,"../IU/IMG.jpg");


CREATE TABLE PUBLICACION(
    ID INT NOT NULL AUTO_INCREMENT,
    PAGO VARCHAR(35) NOT NULL,
    DESCRIPCION VARCHAR(100) NOT NULL,
    PRIMARY KEY (ID),
    IDSERVICE INT NOT NULL,
         FOREIGN KEY (IDSERVICE)
         REFERENCES SERVICIO(ID)
         ON DELETE CASCADE,
    IDPROPIEDAD INT NOT NULL,
             FOREIGN KEY (IDPROPIEDAD)
             REFERENCES PROPIEDAD(ID)
             ON DELETE CASCADE
);